package com.zmen.backend.entity;

import jakarta.persistence.*;
import java.math.BigDecimal;
import java.time.LocalDateTime;
import java.util.Set;

@Entity
@Table(name = "hoa_don")
public class HoaDon {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "ma_hoa_don", length = 50, unique = true)
    private String maHoaDon;
    
    @ManyToOne
    @JoinColumn(name = "nguoi_dung_id", referencedColumnName = "id")
    private User nguoiDung;
    
    @ManyToOne
    @JoinColumn(name = "nhan_vien_id", referencedColumnName = "id")
    private NhanVien nhanVien;
    
    @Column(name = "loai_hoa_don")
    private String loaiHoaDon; // ONLINE, OFFLINE, B2B
    
    @Column(name = "tong_so_luong")
    private Integer tongSoLuong;
    
    @Column(name = "tong_tien_hang", precision = 15, scale = 2)
    private BigDecimal tongTienHang;
    
    @Column(name = "tong_tien_giam_gia", precision = 15, scale = 2)
    private BigDecimal tongTienGiamGia = BigDecimal.ZERO;
    
    @Column(name = "phi_van_chuyen", precision = 15, scale = 2)
    private BigDecimal phiVanChuyen = BigDecimal.ZERO;
    
    @Column(name = "tong_tien_thanh_toan", precision = 15, scale = 2)
    private BigDecimal tongTienThanhToan;
    
    @Column(name = "ma_voucher", length = 50)
    private String maVoucher;
    
    @Column(name = "gia_tri_voucher", precision = 15, scale = 2)
    private BigDecimal giaTriVoucher = BigDecimal.ZERO;
    
    @Column(name = "diem_su_dung")
    private Integer diemSuDung = 0;
    
    @Column(name = "gia_tri_diem", precision = 15, scale = 2)
    private BigDecimal giaTriDiem = BigDecimal.ZERO;
    
    @Column(name = "diem_tich_luy")
    private Integer diemTichLuy = 0;
    
    // Địa chỉ giao hàng
    @Column(name = "ten_nguoi_nhan", length = 100)
    private String tenNguoiNhan;
    
    @Column(name = "so_dien_thoai_nguoi_nhan", length = 15)
    private String soDienThoaiNguoiNhan;
    
    @Column(name = "dia_chi_giao_hang", length = 500)
    private String diaChiGiaoHang;
    
    @Column(name = "phuong_xa", length = 100)
    private String phuongXa;
    
    @Column(name = "quan_huyen", length = 100)
    private String quanHuyen;
    
    @Column(name = "tinh_thanh_pho", length = 100)
    private String tinhThanhPho;
    
    @Column(name = "ma_buu_dien", length = 10)
    private String maBuuDien;
    
    // Thông tin thanh toán
    @Column(name = "phuong_thuc_thanh_toan")
    private String phuongThucThanhToan; // CASH, CARD, BANK_TRANSFER, STRIPE, PAYPAL
    
    @Column(name = "trang_thai_thanh_toan")
    private String trangThaiThanhToan; // PENDING, PAID, FAILED, REFUNDED
    
    @Column(name = "ngay_thanh_toan")
    private LocalDateTime ngayThanhToan;
    
    // Trạng thái đơn hàng
    @Column(name = "trang_thai_don_hang")
    private String trangThaiDonHang; // PENDING, CONFIRMED, PROCESSING, SHIPPING, DELIVERED, CANCELLED, RETURNED
    
    @Column(name = "ngay_xac_nhan")
    private LocalDateTime ngayXacNhan;
    
    @Column(name = "ngay_giao_hang")
    private LocalDateTime ngayGiaoHang;
    
    @Column(name = "ngay_hoan_thanh")
    private LocalDateTime ngayHoanThanh;
    
    @Column(name = "ghi_chu", length = 500)
    private String ghiChu;
    
    @Column(name = "ly_do_huy", length = 255)
    private String lyDoHuy;
    
    @Column(name = "created_at")
    private LocalDateTime createdAt;
    
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;
    
    @OneToMany(mappedBy = "hoaDon", cascade = CascadeType.ALL)
    private Set<ChiTietHoaDon> chiTietHoaDons;
    
    @PrePersist
    protected void onCreate() {
        createdAt = LocalDateTime.now();
        updatedAt = LocalDateTime.now();
    }
    
    @PreUpdate
    protected void onUpdate() {
        updatedAt = LocalDateTime.now();
    }
    
    // Constructors
    public HoaDon() {}
    
    public HoaDon(String maHoaDon, User nguoiDung, String loaiHoaDon) {
        this.maHoaDon = maHoaDon;
        this.nguoiDung = nguoiDung;
        this.loaiHoaDon = loaiHoaDon;
        this.trangThaiDonHang = "PENDING";
        this.trangThaiThanhToan = "PENDING";
    }
    
    // Getters and Setters
    public Long getId() {
        return id;
    }
    
    public void setId(Long id) {
        this.id = id;
    }
    
    public String getMaHoaDon() {
        return maHoaDon;
    }
    
    public void setMaHoaDon(String maHoaDon) {
        this.maHoaDon = maHoaDon;
    }
    
    public User getNguoiDung() {
        return nguoiDung;
    }
    
    public void setNguoiDung(User nguoiDung) {
        this.nguoiDung = nguoiDung;
    }
    
    public NhanVien getNhanVien() {
        return nhanVien;
    }
    
    public void setNhanVien(NhanVien nhanVien) {
        this.nhanVien = nhanVien;
    }
    
    public String getLoaiHoaDon() {
        return loaiHoaDon;
    }
    
    public void setLoaiHoaDon(String loaiHoaDon) {
        this.loaiHoaDon = loaiHoaDon;
    }
    
    public Integer getTongSoLuong() {
        return tongSoLuong;
    }
    
    public void setTongSoLuong(Integer tongSoLuong) {
        this.tongSoLuong = tongSoLuong;
    }
    
    public BigDecimal getTongTienHang() {
        return tongTienHang;
    }
    
    public void setTongTienHang(BigDecimal tongTienHang) {
        this.tongTienHang = tongTienHang;
    }
    
    public BigDecimal getTongTienGiamGia() {
        return tongTienGiamGia;
    }
    
    public void setTongTienGiamGia(BigDecimal tongTienGiamGia) {
        this.tongTienGiamGia = tongTienGiamGia;
    }
    
    public BigDecimal getPhiVanChuyen() {
        return phiVanChuyen;
    }
    
    public void setPhiVanChuyen(BigDecimal phiVanChuyen) {
        this.phiVanChuyen = phiVanChuyen;
    }
    
    public BigDecimal getTongTienThanhToan() {
        return tongTienThanhToan;
    }
    
    public void setTongTienThanhToan(BigDecimal tongTienThanhToan) {
        this.tongTienThanhToan = tongTienThanhToan;
    }
    
    public String getMaVoucher() {
        return maVoucher;
    }
    
    public void setMaVoucher(String maVoucher) {
        this.maVoucher = maVoucher;
    }
    
    public BigDecimal getGiaTriVoucher() {
        return giaTriVoucher;
    }
    
    public void setGiaTriVoucher(BigDecimal giaTriVoucher) {
        this.giaTriVoucher = giaTriVoucher;
    }
    
    public Integer getDiemSuDung() {
        return diemSuDung;
    }
    
    public void setDiemSuDung(Integer diemSuDung) {
        this.diemSuDung = diemSuDung;
    }
    
    public BigDecimal getGiaTriDiem() {
        return giaTriDiem;
    }
    
    public void setGiaTriDiem(BigDecimal giaTriDiem) {
        this.giaTriDiem = giaTriDiem;
    }
    
    public Integer getDiemTichLuy() {
        return diemTichLuy;
    }
    
    public void setDiemTichLuy(Integer diemTichLuy) {
        this.diemTichLuy = diemTichLuy;
    }
    
    public String getTenNguoiNhan() {
        return tenNguoiNhan;
    }
    
    public void setTenNguoiNhan(String tenNguoiNhan) {
        this.tenNguoiNhan = tenNguoiNhan;
    }
    
    public String getSoDienThoaiNguoiNhan() {
        return soDienThoaiNguoiNhan;
    }
    
    public void setSoDienThoaiNguoiNhan(String soDienThoaiNguoiNhan) {
        this.soDienThoaiNguoiNhan = soDienThoaiNguoiNhan;
    }
    
    public String getDiaChiGiaoHang() {
        return diaChiGiaoHang;
    }
    
    public void setDiaChiGiaoHang(String diaChiGiaoHang) {
        this.diaChiGiaoHang = diaChiGiaoHang;
    }
    
    public String getPhuongXa() {
        return phuongXa;
    }
    
    public void setPhuongXa(String phuongXa) {
        this.phuongXa = phuongXa;
    }
    
    public String getQuanHuyen() {
        return quanHuyen;
    }
    
    public void setQuanHuyen(String quanHuyen) {
        this.quanHuyen = quanHuyen;
    }
    
    public String getTinhThanhPho() {
        return tinhThanhPho;
    }
    
    public void setTinhThanhPho(String tinhThanhPho) {
        this.tinhThanhPho = tinhThanhPho;
    }
    
    public String getMaBuuDien() {
        return maBuuDien;
    }
    
    public void setMaBuuDien(String maBuuDien) {
        this.maBuuDien = maBuuDien;
    }
    
    public String getPhuongThucThanhToan() {
        return phuongThucThanhToan;
    }
    
    public void setPhuongThucThanhToan(String phuongThucThanhToan) {
        this.phuongThucThanhToan = phuongThucThanhToan;
    }
    
    public String getTrangThaiThanhToan() {
        return trangThaiThanhToan;
    }
    
    public void setTrangThaiThanhToan(String trangThaiThanhToan) {
        this.trangThaiThanhToan = trangThaiThanhToan;
    }
    
    public LocalDateTime getNgayThanhToan() {
        return ngayThanhToan;
    }
    
    public void setNgayThanhToan(LocalDateTime ngayThanhToan) {
        this.ngayThanhToan = ngayThanhToan;
    }
    
    public String getTrangThaiDonHang() {
        return trangThaiDonHang;
    }
    
    public void setTrangThaiDonHang(String trangThaiDonHang) {
        this.trangThaiDonHang = trangThaiDonHang;
    }
    
    public LocalDateTime getNgayXacNhan() {
        return ngayXacNhan;
    }
    
    public void setNgayXacNhan(LocalDateTime ngayXacNhan) {
        this.ngayXacNhan = ngayXacNhan;
    }
    
    public LocalDateTime getNgayGiaoHang() {
        return ngayGiaoHang;
    }
    
    public void setNgayGiaoHang(LocalDateTime ngayGiaoHang) {
        this.ngayGiaoHang = ngayGiaoHang;
    }
    
    public LocalDateTime getNgayHoanThanh() {
        return ngayHoanThanh;
    }
    
    public void setNgayHoanThanh(LocalDateTime ngayHoanThanh) {
        this.ngayHoanThanh = ngayHoanThanh;
    }
    
    public String getGhiChu() {
        return ghiChu;
    }
    
    public void setGhiChu(String ghiChu) {
        this.ghiChu = ghiChu;
    }
    
    public String getLyDoHuy() {
        return lyDoHuy;
    }
    
    public void setLyDoHuy(String lyDoHuy) {
        this.lyDoHuy = lyDoHuy;
    }
    
    public LocalDateTime getCreatedAt() {
        return createdAt;
    }
    
    public void setCreatedAt(LocalDateTime createdAt) {
        this.createdAt = createdAt;
    }
    
    public LocalDateTime getUpdatedAt() {
        return updatedAt;
    }
    
    public void setUpdatedAt(LocalDateTime updatedAt) {
        this.updatedAt = updatedAt;
    }
    
    public Set<ChiTietHoaDon> getChiTietHoaDons() {
        return chiTietHoaDons;
    }
    
    public void setChiTietHoaDons(Set<ChiTietHoaDon> chiTietHoaDons) {
        this.chiTietHoaDons = chiTietHoaDons;
    }
}

